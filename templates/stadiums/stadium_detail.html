{% extends "base.html" %}
{% block title %}ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù„Ø¹Ø¨ - {{ stadium.name }}{% endblock %}

{% block content %}
<div class="container mt-4" style="max-width: 1200px;">
    
    <h2 class="stadium-header-title">ğŸŸï¸ {{ stadium.name }}</h2>
    <p class="lead" style="color: var(--bright-cyan);">ğŸ“ {{ stadium.location }}</p>

    {% if stadium.images.exists %}
        <div class="row mb-4">
            {% for img in stadium.images.all %}
                <div class="col-md-3 mb-3">
                    <img src="{{ img.image.url }}" class="gallery-img" alt="{{ img.caption }}">
                    <p class="text-muted small mt-2 text-center">{{ img.caption }}</p>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <hr style="border-top: 2px dashed #555;">

    {% if messages %}
        <div class="mb-4">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}

    <div class="card-3d mb-4 p-4">
        <form method="get" class="row g-3 align-items-center modern-form">
            <div class="col-md-4">
                <label for="dayInput">Ø§Ø®ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                <input type="date" name="day" id="dayInput" value="{{ day|date:'Y-m-d' }}">
            </div>
            <div class="col-md-4">
                <div class="form-check mt-4">
                    <input type="checkbox" name="only_available" value="1" class="form-check-input" id="onlyAvailableCheck" {% if only_available %}checked{% endif %}>
                    <label class="form-check-label" for="onlyAvailableCheck" style="display:inline;">Ø¹Ø±Ø¶ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ÙÙ‚Ø·</label>
                </div>
            </div>
            <div class="col-md-4">
                <button type="submit" class="btn btn-primary w-100 mt-4">ğŸ” ØªØµÙÙŠØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
            </div>
        </form>
    </div>

    {% for fdata in all_fields %}
        <div class="stadium-card">
            <div class="stadium-card-header d-flex justify-content-between align-items-center flex-wrap">
                <h5 class="mb-0">
                    ğŸ¥… {{ fdata.field.name }}
                    {% if fdata.field.area %} <span class="badge bg-light text-dark ms-2">ğŸ“ {{ fdata.field.area }} Ù…Â²</span> {% endif %}
                </h5>
                <a href="{% url 'field_schedule' fdata.field.id %}" class="btn btn-sm btn-light text-dark">ğŸ“… Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ</a>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="cyan-table mb-0">
                        <thead>
                            <tr>
                                <th>Ù…Ù†</th>
                                <th>Ø¥Ù„Ù‰</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for slot in fdata.slots %}
                                <tr>
                                    <td class="fw-bold">{{ slot.start|time:"H:i" }}</td>
                                    <td class="fw-bold">{{ slot.end|time:"H:i" }}</td>
                                    <td>
                                        {% if slot.status == "available" %}<span class="badge-soft-success">âœ… Ù…ØªØ§Ø­</span>
                                        {% elif slot.status == "confirmed" %}<span class="badge-soft-danger">âœ”ï¸ Ù…Ø­Ø¬ÙˆØ²</span>
                                        {% else %}<span class="badge bg-secondary">ğŸš« ØºÙŠØ± Ù…ØªØ§Ø­</span>{% endif %}
                                    </td>
                                    <td>
                                        {% if slot.status == "available" %}
                                            <form method="post" action="{% url 'create_booking' fdata.field.id %}" class="d-inline">
                                                {% csrf_token %}
                                                <input type="hidden" name="start" value="{{ slot.start|date:'Y-m-d H:i' }}">
                                                <button type="submit" class="btn btn-success btn-sm">ğŸ“‹ Ø­Ø¬Ø² Ø³Ø±ÙŠØ¹</button>
                                            </form>
                                        {% else %}
                                            <span class="text-muted">-</span>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% empty %}
                                <tr><td colspan="4" class="text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙØªØ±Ø§Øª Ø²Ù…Ù†ÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ….</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    {% empty %}
        <p class="text-center text-muted display-6">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø§Ø¹Ø¨ ÙØ±Ø¹ÙŠØ©.</p>
    {% endfor %}

    <div class="mt-4 text-center">
        <a href="{% url 'stadium_list' %}" class="btn btn-modern btn-outline-modern">â†©ï¸ Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©</a>
    </div>
</div>
{% endblock %}